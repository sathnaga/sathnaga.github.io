---
layout: post
title: Deploy OS on OpenPower boxes using op-test-framework
date: '2018-05-22T16:59:00.001+05:30'
author: Satheesh
tags:
- op-test-framework
- deploy
- fedora
- ibm
- power
- DevOps
- openpower
- OS
modified_time: '2018-09-07T10:24:27.930+05:30'
blogger_id: tag:blogger.com,1999:blog-3781127847171836973.post-6817938331141109442
blogger_orig_url: http://www.sathnaga86.com/2018/05/deploy-os-on-openpower-boxes-using-op.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><h4 style="text-align: left;"><i><br />This blog explains about my patches to the op-test-framework to improve/enable OS deployment on OpenPower boxes.</i></h4><br /><h4 style="text-align: left;"><u><b>Introduction:</b></u></h4><a href="https://github.com/open-power/op-test-framework" target="_blank">op-test-framework</a> is a python unittest based test suite for validating OpenPower boxes,<br />which comprises many tests including booting host with multiple configurations etc.<br /><br /><h4 style="text-align: left;"><b><u>Patches that enabled the support:</u></b></h4><a href="https://github.com/open-power/op-test-framework" target="_blank">op-test-framework</a>:<span style="color: blue;"> *</span><br />4edece0 Add support for HostOS Installation<br />1b581fb Add support for RHEL OS installation<br />c2a96d4 Add install library and update Ubuntu install test<br />830a43c Add commandline params needed for OS deploy<br />403d141 Fallback to alternate method to determine ip for boxes with older nc utility<br /><span style="color: blue; font-size: x-small;"><i>* Merged in upstream</i></span><br /><h4 style="text-align: left;"><b><u><br /></u></b></h4><h4 style="text-align: left;"><b><u>Steps to deploy OS:</u></b></h4>Lets see how to deploy Fedora28 on IBM Power Host.<br /><br />$git clone&nbsp;https://github.com/open-power/op-test-framework<br />$cd op-test-framework<br /><br /><i><span style="color: blue;">create a machine.conf to match the host that you want to deploy like below</span></i><br /><br />[op-test]<br />bmc_type=OpenBMC<br />bmc_ip=x.x.x.x<br />bmc_username=ADMIN<br />bmc_password=ADMIN<br />bmc_usernameipmi=ADMIN<br />bmc_passwordipmi=ADMIN<br />host_ip=x.x.x.x<br />host_user=root<br />host_password=passw0rd<br />host_gateway=x.x.x.x<br />host_dns=x.x.x.x<br />host_mac=98:be:94:06:de:95 <span style="font-size: x-small;"><i>--&gt;change as per your host</i></span><br />host_submask=255.255.255.0&nbsp;<span style="font-size: x-small;"><i> --&gt;change as per your host</i></span><br />host_scratch_disk=/dev/disk/by-id/scsi-35000c50098a05d6f&nbsp; <span style="font-size: x-small;"><i>--&gt;change as per your host</i></span><br />os_repo=https://dl.fedoraproject.org/pub/fedora-secondary/releases/28/Server/ppc64le/os/<br /><br /><span style="color: blue; font-size: x-small;"><i>Running OS deploy test....</i></span><br />$./op-test -c machine.conf --run testcases.InstallRhel.InstallRhel<br /><span style="font-size: xx-small;">....</span><br /><span style="font-size: xx-small;">....</span><br /><span style="font-size: xx-small;">^[[32m[&nbsp; &nbsp;39.218896] ^[[0m^[[33mtg3 0005:09:00.0 net0^[[0m: EEE is disabled</span><br /><span style="font-size: xx-small;">^[[32m[&nbsp; &nbsp;39.218976] ^[[0m^[[33mIPv6^[[0m: ADDRCONF(NETDEV_CHANGE): net0: link becomes ready</span><br /><span style="font-size: xx-small;">[console-pexpect]#echo $?</span><br /><span style="font-size: xx-small;">0</span><br /><span style="font-size: xx-small;">/home/jenkins_data/sath/op-test-framework/test-reports/Kernel_dmesg_log_Thu_May_17_11:20:20_2018.log</span><br /><span style="font-size: xx-small;">OK (939.294s)</span><br /><span style="font-size: xx-small;"><br /></span><span style="font-size: xx-small;">----------------------------------------------------------------------</span><br /><span style="font-size: xx-small;">Ran 1 test in 939.294s</span><br /><span style="font-size: xx-small;"><br /></span><span style="font-size: xx-small;">OK</span><br /><span style="font-size: xx-small;"><br /></span><span style="font-size: xx-small;">Generating XML reports...</span><br /><span style="font-size: xx-small;">Output written to: /home/jenkins_data/sath/op-test-framework/test-reports/*20180517110439*</span><br /><div><br /><i>Now you have<span style="color: blue;"> IBM Power</span>&nbsp;system with Fedora28 installed!!</i></div><br /><a name='more'></a><br /><br />P:S:-<i> osimages/rhel/rhel.ks has the template for kickstart file, you can tune based on the packages that you want to install, for installing fedora make sure java is removed as it does not available in fedora repository.</i><br /><br /><br /><br /><div><i><span style="color: blue;"><br class="Apple-interchange-newline" />Hope this helps you in someways!!!!</span></i></div><div><i><span style="color: blue;">Thanks for taking time in reading this blog......</span></i></div><br /></div>